name: Cert-Weave CI/CD
on: [push, pull_request]

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Install Root Dependencies
        run: npm ci # Use 'ci' for consistent builds

      - name: Run Global Lint
        # This will now use the updated eslint.config.mjs 
        # which handles both Backend and Frontend correctly
        run: npx eslint . 

  build-docker:
    needs: lint
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Build Node Backend
        run: docker build -t cert-weave-backend ./Backend -f Backend/Dockerfile
      - name: Build Python Service
        run: docker build -t cert-weave-python ./Backend -f Backend/Dockerfile.python